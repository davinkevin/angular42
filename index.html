<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">
		<link rel="stylesheet" href="css/theme/custom.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/darcula.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

				<section data-background="images/cover.jpg">
						<div id="cover">
							<h2>Angular 42</h2>
							<h5>On en est o√π ?</h5>
						</div>
				</section>

				<section id="introduction">
					<section data-background="images/introduction/announcement.png">
						&nbsp;
					</section>
					<section id="angular_announcement">
						<img src="images/introduction/angular_logo.png" alt="angular logo">
					</section>
					<section>
						And almost two years later...
					</section>
					<section data-background="images/introduction/angular-2-release-balloons.jpg">
						<h4>Angular2 Release !</h4>
						<h5 class="fragment">finally...</h5>
					</section>
				</section>
				<section id="during_last_two_years">
					<section id="angular_loose_2">
						<div>
							<img src="images/introduction/angular_logo.png" alt="angular logo">
							Angular
							<div class="fragment fade-out" data-fragment-index="1">2</div>
						</div>
					</section>
					<section id="its_just_angular">
						<img src="images/introduction/twitter_logo.png" class="as_character"> <a href="https://twitter.com/hashtag/itsjustangular">#ItsJustAngular</a>
					</section>
					<section id="angular_v4">
						<p>March 2017</p>
						<img src="images/introduction/angular_logo.png" class="as_character"> Release of v4
					</section>
					<section id="angular_v5">
						<p>November 2017</p>
						<img src="images/introduction/angular_logo.png" class="as_character"> Release of v5
					</section>
					<section id="angular_v6">
						<p>May 2018</p>
						<img src="images/introduction/angular_logo.png" class="as_character"> Release of v6
					</section>
					<section id="moving_version" data-background="/images/introduction/rolling_update_angular.gif">
						&nbsp;
					</section>
				</section>
				<section id="who_am_i">
					<section id="me" data-background-color="white">
						<img src="images/introduction/github_davinkevin.png" alt="github davinkevin">
					</section>
					<section id="who_i_working_for" data-background-color="white">
						<img src="images/introduction/logo-stacklab.png" alt="stack labs">
					</section>
					<section id="where_i_m_working">
						<h2>
							<span class="fragment">üõ∞</span>
							<span class="fragment"> + üõ©</span>
							<span class="fragment">
								 + <img class="logo_toulouse" src="images/introduction/toulouse.png" alt="toulouse">
							</span>
							<span class="fragment">
								= ü§î
							</span>
						</h2>
					</section>
					<section id="team" data-background="images/introduction/team.jpg">
						&nbsp;
					</section>
					<section id="projects" data-background="images/introduction/projects.jpg">
						&nbsp;
					</section>
				</section>

				<section id="in_the_framework">
					<h3> üéâ Angular 6</h3>
				</section>

				<section id="tree_shakeable_provider">

					<section data-background="/images/angular6/injector/injector.jpg">
						<h3><code>@Injectable() provider</code></h3>
					</section>

					<section>
						<p>Before Angular 6, creating a service looks like this</p>
						<pre><code class="hljs typescript">// hero.service.ts
@Injectable()
export class HeroService {
  constructor(private http: HttpClient){}
}						</code></pre>
						<pre class="fragment"><code class="hljs typescript">// hero.module.ts
@NgModule({
 providers: [HeroService],
})
export class HeroModule() {}</code></pre>
					</section>
					<section>
						<p>In Angular 6</p>
						<pre><code class="hljs typescript">// hero.service.ts
@Injectable({
 provideIn: HeroModule // or 'root'
})
export class HeroService {
  constructor(private http: HttpClient){}
}						</code></pre>
						<pre class="fragment"><code class="hljs typescript">// hero.module.ts
@NgModule({})
export class HeroModule() {}</code></pre>
					</section>
					<section>
						<p>Same thing for <code>InjectionToken</code></p>
						<pre><code class="hljs typescript" data-trim data-noescape>
const TOKEN = new InjectionToken&lt;Config&gt;('Config'<span class="fragment">, {
  providedIn: HeroModule,
  factory: () => { value: 'foo' },
}</span>);
						</code></pre>
					</section>

					<section>
						<h4>Comparison</h4>
						<p>With 100 Services, <code>ng build --prod</code></p>
						<pre class="fragment" data-fragment-index="1"><code>// With NgModule.providers
chunk {3} main.js (main) 171 kB [initial] [rendered]</code></pre>
						<pre class="fragment" data-fragment-index="1"><code>$ cat main.js | grep -o wonde | wc -l
$ 100</code></pre>
						<pre class="fragment" data-fragment-index="2"><code>// With @Injectable.provideIn
chunk {3} main.js (main) 158 kB [initial] [rendered]</code></pre>
						<pre class="fragment" data-fragment-index="2"><code>$ cat main.js | grep -o wonde | wc -l
$ 0</code></pre>
					</section>

					<section>
						<h5>Benefits</h5>
						<ul>
							<li>Smaller bundle thanks to üå≥-shaking</li>
							<li>Reduce boilerplate into <code>@NgModule</code></li>
							<li>Avoid to import useless code from lib üòé</li>
							<li>Simplify unit-testing</li>
						</ul>
					</section>
				</section>
				<section>
					<section data-background="/images/angular6/ivy/ivy.jpg">
						<h3>Ivy Renderer</h3>
					</section>

					<section data-background="/images/angular6/ivy/transformation.gif">
						&nbsp;
					</section>

					<section data-background="/images/angular6/ivy/change.jpg">
						&nbsp;
					</section>

					<section>
						<ul>
							<li>Angular2 ‚Üí Original Renderer</li>
							<li class="fragment">Angular v4 ‚Üí Renderer2</li>
							<li class="fragment">Angular 7? ‚Üí Renderer3 <span class="fragment">alias Ivy üçÉ</span></li>
						</ul>
					</section>



					<section>
						<p>What is the difference for my code ?</p>
						<pre><code>@Component({
  selector: 'app-test-comp1',
  template: `
    <div>
      <p>Hello {{ title }}</p>
    </div>
  `
})
export class TestComp1Component implements OnInit {
  title: string = 'world';
  ngOnInit() {
    this.title = "Luxembourg";
  }
}						</code></pre>
					</section>

					<section>
						NONE ! ü§©
					</section>

					<section>
						But the generated code will change !
					</section>

					<section>
						<h3>With Render2</h3>
						<pre><code>// app.component.ngfactory.js
export function View_AppComponent_0() {
  return viewDef(0, [
      elementDef(0, 0, null, null, 2, "div", [], null, null, null, null, null),
      elementDef(1, 0, null, null, 1, "p", [], null, null, null, null, null),
      textDef(2, null, ["Hello ", ""])
    ], null, function (check, view) {
      var comp = view.component;
      var value = comp.title;
      check(view, 2, 0, value);
    }
  );
}</code></pre>
					</section>
					<section>
						<p>And the sub-layer structure of the <code>createViewNodes</code></p>
						<pre><code>function createViewNodes(view: ViewData) {
 view.nodes.forEach(n => {
  switch (n.flags & NodeFlags.Types) {
   case NodeFlags.TypeElement: return element(n);
   case NodeFlags.TypeText: return text(n);
   case NodeFlags.TypeValueProvider: return valueProvider(n);
   case NodeFlags.TypePipe: return pipe(n);
   case NodeFlags.TypeDirective: return directive(n);
   case NodeFlags.TypePurePipe: return purePipe(n);
   case NodeFlags.TypeViewQuery: return viewQuery(n);
   case NodeFlags.TypeNgContent: return ngContent(n);
   ...
  }
 }</code></pre>
					</section>
                    <section>
                        <p>with Renderer2</p>
                        <ul>
                            <li><code>app.component.js</code></li>
                            <li><code>app.component.ngfactory.js</code></li>
                        </ul>
                    </section>

					<section>
						<h3>with Ivy üçÉ</h3>
						<pre><code>// app.component.js
import { Component } from '@angular/core';
import * as i0 from "@angular/core";
export class AppComponent {
    constructor() {
        this.title = 'World';
    }
    updateTitle() {
        this.title = 'Luxembourg !';
    }
}</code></pre>
                    </section>
					<section>
						<h3>with Ivy üçÉ</h3>
                        <pre><code>// app.component.js
AppComponent.ngComponentDef = defineComponent({
 type: AppComponent,
 selectors: [["app-root"]],
 factory: function AppComponent_Factory() { return new AppComponent(); },
 template: ...
});</code></pre>
					</section>
                    <section>
                        <h3>with Ivy üçÉ</h3>
                        <pre><code>function AppComponent_Template(renderFlag, component) {
  if (renderFlag & RenderFlags.Create) {
    elementStart(0, "div");
     elementStart(1, "p");
      text(2);
     elementEnd();
    elementEnd();
  } if (renderFlag & RenderFlags.Update) {
    textBinding(2,
     interpolation1("Hello ", component.title, "")
    );
  }
 }</code></pre>
                    </section>
                    <section>
                        <p>All in one file üí™</p>
                    </section>
                    <section>
                        <p>Integrate only what we need ‚úÇÔ∏è</p>
                        <p class="fragment">So, it's smaller</p>
                    </section>
					<section data-background="/images/angular6/ivy/small.jpg">
						&nbsp;
					</section>
					<section>
						<p>Size comparison</p>
						<pre><code>$ du -sh dist/
172K	ivy-renderer-ivy
272K	ivy-renderer-renderer2</code></pre>
						<pre class="fragment"><code>$ du -sh main.*.js
189K	main.renderer2.js
92K	main.ivy.js</code></pre>
						<span class="fragment">üòç</span>
					</section>
                    <section>
                        <p>Simpler ü§ì</p>
                        <p class="fragment">The generated code is human-readable</p>
                    </section>
                    <section>
                        <p>Debug friendly üë©‚Äçüíª</p>
                        <p class="fragment">üî¥ into the html !</p>
                    </section>
                    <section>
                        <p>But still in progress üë®‚Äçüî¨</p>
                        <a href="https://is-angular-ivy-ready.firebaseapp.com/#/status">üîç Look at it</a>
                    </section>
				</section>
				<section id="angular_elements">
					<section data-background="images/angular6/angular-elements/intro.jpg">
						<angular-elements-event event-name="VoxxedDays Luxembourg"></angular-elements-event>
					</section>
					<section>
						<p>Coming from Angular-Labs</p>
						<img src="images/angular6/angular-elements/angular-labs.png" alt="angular-labs" style="width: 200px">
					</section>
					<section>
						<p>And still very young üê£</p>
					</section>
					<section>
						<p>The goal of Angular-Elements</p>
						<p class="fragment">Provide all the power of Angular to build <br/><code>custom-elements</code></p>
					</section>
					<section id="use_them_everywhere">
						<p>and use them inside every app...</p>
						<div class="frameworks">
							<img class="fragment" src="images/angular6/angular-elements/vuejs.png" alt="vuejs">
							<img class="fragment" src="images/angular6/angular-elements/preact.png" alt="preact">
							<img class="fragment" src="images/angular6/angular-elements/react.svg" alt="react">
							<img class="fragment" src="images/angular6/angular-elements/polymer.png" alt="polymer">
						</div>
					</section>
					<section data-background-image="images/angular6/angular-elements/boring.gif">
						<span class="fragment">How can we do that ?</span>
					</section>
					<section>
						<p>Like you already do üëç</p>
						<p class="fragment">...with some differences üòÆ</p>
					</section>
					<section>
						<p>Component</p>
						<pre><code data-noescape >@Component({
  selector: 'angular-elements-event',
  templateUrl: './angular-elements-event.html',
  <span class="fragment">encapsulation: ViewEncapsulation.Native // üëÅ</span>
})
export class AngularElementsEvent {
  year = 2018;
  @Input() eventName : string = 'No label...';
  @Output() action = new EventEmitter&ltstring&gt();

  emit() {
    this.action.emit(this.eventName + ' ' + this.year);
    this.year += 1;
  }
}					</code></pre>
					</section>
					<section>
						<code>ViewEncapsulation.Native</code>
						<p class="fragment">Because it's part of the W3C spec !</p>
					</section>
					<section>
						<p>And the module</p>
						<pre><code>@NgModule({
  declarations: [AngularElementsEvent],
  entryComponents: [AngularElementsEvent],
  imports: [BrowserModule],
})
export class AppModule {
 constructor(private injector: Injector) { }

 ngDoBootstrap() {
  const element = createCustomElement(AngularElementsEvent,
   { injector: this.injector }
  );
  customElements.define('angular-elements-event', element);
  }
}					</code></pre>
					</section>
					<section data-background-video="images/angular6/angular-elements/drop-the-mic.mp4">
						&nbsp;
					</section>
					<section>
						<p>And you can use it like a real Web-Components</p>
						<pre><code>
 &ltangular-elements-event event-name="VoxxedDays Luxembourg"&gt
 &lt/angular-elements-event&gt

 &ltscript&gt
  const element = document.querySelector('angular-elements-event');
  element.addEventListener('action', function(v) {
   console.log(v);
  });
 &lt/script&gt			</code></pre>
					</section>
					<section data-background-image="images/angular6/angular-elements/remember.gif">
						&nbsp;
					</section>
					<section data-background="images/angular6/angular-elements/intro.jpg">
						<angular-elements-event event-name="VoxxedDays Luxembourg"></angular-elements-event>
					</section>
					<section data-background="images/angular6/angular-elements/problem.gif">
						&nbsp;
					</section>
					<section>
						Yes üò∞
					</section>
                    <section>
                        <p>Size of the üéÅ</p>
                        <pre><code data-noescape>$ ls | grep aee | xargs du -sh
220K	aee.js <span class="fragment">üò±</span>
72K	aee.js.gz           </code></pre>
                    </section>
					<section>
						<p>There is no tooling for this right now üõ†</p>
					</section>
					<section>
						<p> üòì So we create our own...</p>
						<pre><code>
"build": "ng build --prod --output-hashing none",
"postbuild": "cat dist/{runtime,polyfills,scripts,main}.js | gz > ae.js",
						</code></pre>
					</section>
                    <section>
                        <p>Or we can use some <code>ng</code> extensions</p>
                        <p class="fragment"><a href="https://www.npmjs.com/package/ngx-build-plus">ngx-build-plus</a> with webpack extra</p>
                    </section>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>
		<script src="demo/angular-elements-example/elements/aee.js"></script>
		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
                history: true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});

            const elements = document.querySelectorAll('angular-elements-event');
            elements.forEach(e => e.addEventListener('action', function(v) { console.log(v); }));
		</script>
	</body>
</html>
